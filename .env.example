# Rate Limiter Environment Configuration
# 
# This file contains all available environment variables for configuring rate limiting.
# Copy this file to .env and customize as needed.

# ============================================================================
# GLOBAL RATE LIMITS
# ============================================================================

# Global rate limit (applies to all requests)
RATE_LIMIT_GLOBAL_CAPACITY=1000
RATE_LIMIT_GLOBAL_REFILL_RATE=16.67
RATE_LIMIT_GLOBAL_INTERVAL=1000

# Per-IP rate limit
RATE_LIMIT_PER_IP_CAPACITY=100
RATE_LIMIT_PER_IP_REFILL_RATE=1.67
RATE_LIMIT_PER_IP_INTERVAL=1000

# Per-user rate limit
RATE_LIMIT_PER_USER_CAPACITY=500
RATE_LIMIT_PER_USER_REFILL_RATE=8.33
RATE_LIMIT_PER_USER_INTERVAL=1000
RATE_LIMIT_PER_USER_FALLBACK_TO_IP=false

# Per-endpoint rate limit
RATE_LIMIT_PER_ENDPOINT_CAPACITY=50
RATE_LIMIT_PER_ENDPOINT_REFILL_RATE=0.83
RATE_LIMIT_PER_ENDPOINT_INTERVAL=1000

# Sensitive endpoints (login, password reset, etc.)
RATE_LIMIT_SENSITIVE_CAPACITY=5
RATE_LIMIT_SENSITIVE_REFILL_RATE=0.083
RATE_LIMIT_SENSITIVE_INTERVAL=1000

# ============================================================================
# HEADERS CONFIGURATION
# ============================================================================

# Use standard draft spec headers (RateLimit-*)
RATE_LIMIT_STANDARD_HEADERS=true

# Use legacy headers (X-RateLimit-*)
RATE_LIMIT_LEGACY_HEADERS=true

# Include Retry-After header on 429 responses
RATE_LIMIT_RETRY_AFTER_HEADER=true

# ============================================================================
# COST-BASED RATE LIMITING
# ============================================================================

# Default token cost per request
RATE_LIMIT_DEFAULT_COST=1

# Cost tiers for common operations
RATE_LIMIT_COST_READ=1
RATE_LIMIT_COST_WRITE=5
RATE_LIMIT_COST_SEARCH=10
RATE_LIMIT_COST_ANALYTICS=20
RATE_LIMIT_COST_EXPORT=50
RATE_LIMIT_COST_BULK=100

# ============================================================================
# REDIS CONFIGURATION (for distributed rate limiting)
# ============================================================================

# Redis connection
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_DB=0

# Redis key prefix for rate limit keys
RATE_LIMIT_REDIS_KEY_PREFIX=ratelimit:

# TTL for Redis keys (in seconds)
RATE_LIMIT_REDIS_TTL=3600

# Fail-open on Redis errors (allow requests if Redis is down)
RATE_LIMIT_REDIS_FAIL_OPEN=true

# ============================================================================
# ERROR HANDLING
# ============================================================================

# HTTP status code for rate limit exceeded
RATE_LIMIT_ERROR_STATUS_CODE=429

# Default error message
RATE_LIMIT_ERROR_MESSAGE=Too many requests, please try again later.

# Include detailed error information in response
RATE_LIMIT_ERROR_INCLUDE_DETAILS=true

# ============================================================================
# MONITORING AND LOGGING
# ============================================================================

# Enable logging of rate limit events
RATE_LIMIT_ENABLE_LOGGING=false

# Log level (error, warn, info, debug)
RATE_LIMIT_LOG_LEVEL=warn

# Enable metrics collection
RATE_LIMIT_ENABLE_METRICS=false

# ============================================================================
# SKIP PATTERNS
# ============================================================================

# Additional health check endpoints to skip (comma-separated)
# RATE_LIMIT_SKIP_HEALTH_CHECKS=/custom-health,/my-status

# Additional internal endpoints to skip (comma-separated)
# RATE_LIMIT_SKIP_INTERNAL=/my-internal-api

# Additional static asset patterns to skip (comma-separated)
# RATE_LIMIT_SKIP_STATIC=/uploads,/media

# ============================================================================
# TRUSTED IPs
# ============================================================================

# Trusted IP addresses that bypass rate limiting (comma-separated)
# RATE_LIMIT_TRUSTED_IPS=127.0.0.1,10.0.0.1,192.168.1.100

# ============================================================================
# CUSTOM RATE LIMITS (via environment variables)
# ============================================================================

# You can define custom rate limits for specific endpoints using environment variables:
#
# Example for API rate limit:
# API_RATE_LIMIT_CAPACITY=200
# API_RATE_LIMIT_REFILL=20
# API_RATE_LIMIT_COST=1
#
# Then in your code:
# const config = configManager.getRateLimitFromEnv('API_RATE_LIMIT');
#
# This will return { capacity: 200, refillRate: 20, cost: 1, refillInterval: 1000 }
